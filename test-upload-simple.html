<!DOCTYPE html>
<html>
<head>
    <title>Test GCS Upload</title>
    <style>
        body { font-family: Arial; max-width: 600px; margin: 50px auto; padding: 20px; }
        button { padding: 10px 20px; margin: 10px 0; cursor: pointer; }
        #result { margin-top: 20px; padding: 10px; background: #f0f0f0; }
        img { max-width: 100%; margin-top: 10px; }
    </style>
</head>
<body>
    <h1>Test GCS Upload</h1>
    <input type="file" id="fileInput" accept="image/*,video/*">
    <button onclick="uploadFile()">Upload File</button>
    <div id="result"></div>

    <script>
        async function uploadFile() {
            const fileInput = document.getElementById('fileInput');
            const result = document.getElementById('result');

            if (!fileInput.files[0]) {
                result.innerHTML = '‚ùå Please select a file';
                return;
            }

            const file = fileInput.files[0];
            result.innerHTML = `üì§ Uploading ${file.name}...`;

            const formData = new FormData();
            formData.append('file', file);
            formData.append('userId', 'test-user');

            try {
                const response = await fetch('/api/upload', {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();

                if (response.ok && data.success) {
                    result.innerHTML = `
                        ‚úÖ Upload successful!<br>
                        URL: ${data.url}<br>
                        <img src="${data.url}" alt="Uploaded" onerror="this.src='';this.alt='Failed to load image - check permissions'">
                    `;
                } else {
                    result.innerHTML = `‚ùå Upload failed: ${data.error || data.details || 'Unknown error'}`;
                }
            } catch (error) {
                result.innerHTML = `‚ùå Error: ${error.message}`;
            }
        }
    </script>
</body>
</html>
